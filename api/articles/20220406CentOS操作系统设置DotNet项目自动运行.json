{"title":"CentOS操作系统设置DotNet项目自动运行","slug":"20220406CentOS操作系统设置DotNet项目自动运行","date":"2022-04-06T14:11:10.000Z","updated":"2022-06-06T06:28:38.319Z","comments":true,"path":"api/articles/20220406CentOS操作系统设置DotNet项目自动运行.json","excerpt":"CentOS操作系统部署DotNet项目并设置开机自动运行的方法： [Figure] ","covers":["https://s2.loli.net/2022/06/06/7faubgJelkFACqx.jpg"],"content":"<p>CentOS操作系统部署DotNet项目并设置开机自动运行的方法：</p>\n<p><img src=\"https://s2.loli.net/2022/06/06/7faubgJelkFACqx.jpg\" alt=\"dotnet\"></p>\n<h3 id=\"方法一：通过服务运行，项目依赖运行时环境\"><a href=\"#方法一：通过服务运行，项目依赖运行时环境\" class=\"headerlink\" title=\"方法一：通过服务运行，项目依赖运行时环境\"></a>方法一：通过服务运行，项目依赖运行时环境</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//在 /etc/systemd/system目录下创建xxx.service文件，如eivision.service</span><br><span class=\"line\">vi /etc/systemd/system/kgdit.service</span><br><span class=\"line\">//在文件中粘贴如下内容，WorkingDirectory为项目路径，ExecStart为启动指令</span><br><span class=\"line\"> [Unit]</span><br><span class=\"line\"> Description=kgdit</span><br><span class=\"line\"> [Service]</span><br><span class=\"line\"> WorkingDirectory=/home/kgdit/kgsoft/kgdit_lin64</span><br><span class=\"line\"> ExecStart=/usr/bin/dotnet kgdit.dll</span><br><span class=\"line\"> Restart=always</span><br><span class=\"line\"> RestartSec=10</span><br><span class=\"line\"> [Install]</span><br><span class=\"line\"> WantedBy=multi-user.target</span><br><span class=\"line\"></span><br><span class=\"line\">//其中两种命令的区别是是否有local路径的区别，也许是dotnet版本的区别</span><br><span class=\"line\">//ExecStart=/usr/local/bin/dotnet EIVApp.dll、ExecStart=/usr/bin/dotnet EIVApp.dll</span><br><span class=\"line\"></span><br><span class=\"line\">//使启动生效</span><br><span class=\"line\">systemctl enable kgdit.service</span><br><span class=\"line\">//立即启动项目服务</span><br><span class=\"line\">systemctl start kgdit.service</span><br><span class=\"line\">//重新加载服务</span><br><span class=\"line\">systemctl daemon-reload</span><br><span class=\"line\">//查看服务状态</span><br><span class=\"line\">systemctl status kgdit.service</span><br><span class=\"line\">//重启服务器看是否生效</span><br><span class=\"line\">shutdown -r now</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"方法二：通过服务运行，项目集成运行环境\"><a href=\"#方法二：通过服务运行，项目集成运行环境\" class=\"headerlink\" title=\"方法二：通过服务运行，项目集成运行环境\"></a>方法二：通过服务运行，项目集成运行环境</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//在 /etc/systemd/system目录下创建xxx.service文件，kgdit.service</span><br><span class=\"line\">vi /etc/systemd/system/kgdit.service</span><br><span class=\"line\">//在文件中粘贴如下内容，WorkingDirectory为项目路径，ExecStart为启动指令</span><br><span class=\"line\">[Unit]</span><br><span class=\"line\">Description=kgdit</span><br><span class=\"line\">After=default.target</span><br><span class=\"line\"></span><br><span class=\"line\">[Service]</span><br><span class=\"line\">ExecStart=/home/kgdit/kgsoft/kgdit.sh</span><br><span class=\"line\"></span><br><span class=\"line\">[Install]</span><br><span class=\"line\">WantedBy=default.target</span><br><span class=\"line\"></span><br><span class=\"line\">//使启动生效</span><br><span class=\"line\">systemctl enable kgdit.service</span><br><span class=\"line\">//立即启动项目服务</span><br><span class=\"line\">systemctl start kgdit.service</span><br><span class=\"line\">//重新加载服务</span><br><span class=\"line\">systemctl daemon-reload</span><br><span class=\"line\">//查看服务状态</span><br><span class=\"line\">systemctl status kgdit.service</span><br><span class=\"line\">//重启服务器看是否生效</span><br><span class=\"line\">shutdown -r now</span><br></pre></td></tr></table></figure>\n\n<span id=\"more\"></span>\n\n<h3 id=\"方法三：通过命令运行，项目集成运行环境\"><a href=\"#方法三：通过命令运行，项目集成运行环境\" class=\"headerlink\" title=\"方法三：通过命令运行，项目集成运行环境\"></a>方法三：通过命令运行，项目集成运行环境</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//创建.sh命令执行文件,内容如下</span><br><span class=\"line\">1、第一行#!/bin/sh首先指明脚本的解释器（一定要在第一行，否则报错）</span><br><span class=\"line\">2、第二行# chkconfig:2345 60 30，chkconfig的第一个参数是指定脚本的运行等级，一般为2345即可，第二个参数是脚本的启动优先级（0-100），等级越高，优先级越低，也就启动越晚，第三个参数是关闭优先级，同理启动优先级。</span><br><span class=\"line\">3、脚本的描述信息</span><br><span class=\"line\">#!/bin/sh</span><br><span class=\"line\"># chkconfig:2345 60 30</span><br><span class=\"line\"># description:otfapi</span><br><span class=\"line\">cd /home/centos/kgsoft/otfapi_lin64</span><br><span class=\"line\">./OTFApi</span><br><span class=\"line\">//项目赋予可执行权限</span><br><span class=\"line\">chmod +x ./OTFApi</span><br><span class=\"line\">//后台执行sh命令</span><br><span class=\"line\">nohup sh otfapi.sh &amp;</span><br><span class=\"line\">//上一步运行成功后，按任意键，最后通过exit命令退出终端</span><br><span class=\"line\">exit</span><br><span class=\"line\">//通过端口确认后台程序的进程1111</span><br><span class=\"line\">lsof -i:5000</span><br><span class=\"line\">//结束进程，例如进程ID为1111</span><br><span class=\"line\">kill -9 1111</span><br><span class=\"line\">//重新运行</span><br><span class=\"line\">nohup sh otfapi.sh &amp;</span><br><span class=\"line\"></span><br><span class=\"line\">//将以上方法设置为开机自动运行，将sh文件复制到/etc/init.d目录下；</span><br><span class=\"line\">cp /home/centos/kgsoft/otfapi.sh /etc/init.d/otfapi.sh</span><br><span class=\"line\">//给脚本增加执行权限</span><br><span class=\"line\">chmod +x /etc/init.d/otfapi.sh</span><br><span class=\"line\">//键入开机启动项</span><br><span class=\"line\">chkconfig --add otfapi.sh</span><br><span class=\"line\">chkconfig otfapi.sh on</span><br><span class=\"line\">//查看开机启动情况</span><br><span class=\"line\">chkconfig --list otfapi.sh</span><br></pre></td></tr></table></figure>\n\n","more":"<h3 id=\"方法三：通过命令运行，项目集成运行环境\"><a href=\"#方法三：通过命令运行，项目集成运行环境\" class=\"headerlink\" title=\"方法三：通过命令运行，项目集成运行环境\"></a>方法三：通过命令运行，项目集成运行环境</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//创建.sh命令执行文件,内容如下</span><br><span class=\"line\">1、第一行#!/bin/sh首先指明脚本的解释器（一定要在第一行，否则报错）</span><br><span class=\"line\">2、第二行# chkconfig:2345 60 30，chkconfig的第一个参数是指定脚本的运行等级，一般为2345即可，第二个参数是脚本的启动优先级（0-100），等级越高，优先级越低，也就启动越晚，第三个参数是关闭优先级，同理启动优先级。</span><br><span class=\"line\">3、脚本的描述信息</span><br><span class=\"line\">#!/bin/sh</span><br><span class=\"line\"># chkconfig:2345 60 30</span><br><span class=\"line\"># description:otfapi</span><br><span class=\"line\">cd /home/centos/kgsoft/otfapi_lin64</span><br><span class=\"line\">./OTFApi</span><br><span class=\"line\">//项目赋予可执行权限</span><br><span class=\"line\">chmod +x ./OTFApi</span><br><span class=\"line\">//后台执行sh命令</span><br><span class=\"line\">nohup sh otfapi.sh &amp;</span><br><span class=\"line\">//上一步运行成功后，按任意键，最后通过exit命令退出终端</span><br><span class=\"line\">exit</span><br><span class=\"line\">//通过端口确认后台程序的进程1111</span><br><span class=\"line\">lsof -i:5000</span><br><span class=\"line\">//结束进程，例如进程ID为1111</span><br><span class=\"line\">kill -9 1111</span><br><span class=\"line\">//重新运行</span><br><span class=\"line\">nohup sh otfapi.sh &amp;</span><br><span class=\"line\"></span><br><span class=\"line\">//将以上方法设置为开机自动运行，将sh文件复制到/etc/init.d目录下；</span><br><span class=\"line\">cp /home/centos/kgsoft/otfapi.sh /etc/init.d/otfapi.sh</span><br><span class=\"line\">//给脚本增加执行权限</span><br><span class=\"line\">chmod +x /etc/init.d/otfapi.sh</span><br><span class=\"line\">//键入开机启动项</span><br><span class=\"line\">chkconfig --add otfapi.sh</span><br><span class=\"line\">chkconfig otfapi.sh on</span><br><span class=\"line\">//查看开机启动情况</span><br><span class=\"line\">chkconfig --list otfapi.sh</span><br></pre></td></tr></table></figure>","categories":[{"name":"Linux","path":"api/categories/Linux.json"}],"tags":[{"name":"CentOS","path":"api/tags/CentOS.json"},{"name":"DotNet","path":"api/tags/DotNet.json"}]}