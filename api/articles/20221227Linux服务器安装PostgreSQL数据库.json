{"title":"Linux服务器安装PostgreSQL数据库","slug":"20221227Linux服务器安装PostgreSQL数据库","date":"2022-12-27T14:13:51.000Z","updated":"2022-12-27T06:36:02.460Z","comments":true,"path":"api/articles/20221227Linux服务器安装PostgreSQL数据库.json","excerpt":null,"covers":["https://weaoe.com/hexo/img/2022102900.png","https://s2.loli.net/2022/06/23/bYdtKDC2U5J7iWr.jpg"],"content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><p>Linux服务器安装PostgreSQL数据库</p>\n<img src=\"https://weaoe.com/hexo/img/2022102900.png\" alt=\"PostgreSQL\" style=\"zoom: 80%;\" />\n\n<h2 id=\"下载\"><a href=\"#下载\" class=\"headerlink\" title=\"下载\"></a>下载</h2><ul>\n<li>首先访问<a href=\"https://www.postgresql.org/download/\">https://www.postgresql.org/download/</a></li>\n<li>选择操作系统，下载自己需要的安装包版本</li>\n<li>如果是在线安装，可以直接选在版本、操作系统、架构，然后复制安装命令</li>\n<li>如果是离线安装，直接点击页面最下方的“direc download”进入新页面，选择版本、操作系统、架构后，直接点击Available Groups下的链接，下载安装包。以centos7为例，一般需要下载四个安装包。</li>\n<li>本文使用的最新版本15.0</li>\n</ul>\n<h2 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h2><h3 id=\"上传文件\"><a href=\"#上传文件\" class=\"headerlink\" title=\"上传文件\"></a>上传文件</h3><p>将下载的文件上传到服务器</p>\n<ul>\n<li><p>postgresql15-15.1-1PGDG.rhel7.x86_64.rpm</p>\n</li>\n<li><p>postgresql15-contrib-15.1-1PGDG.rhel7.x86_64.rpm</p>\n</li>\n<li><p>postgresql15-libs-15.1-1PGDG.rhel7.x86_64.rpm</p>\n</li>\n<li><p>postgresql15-server-15.1-1PGDG.rhel7.x86_64.rpm</p>\n</li>\n</ul>\n<h3 id=\"安装顺序\"><a href=\"#安装顺序\" class=\"headerlink\" title=\"安装顺序\"></a>安装顺序</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rpm -ivh postgresql15-libs-15.1-1PGDG.rhel7.x86_64.rpm</span><br><span class=\"line\">rpm -ivh postgresql15-15.1-1PGDG.rhel7.x86_64.rpm</span><br><span class=\"line\">rpm -ivh postgresql15-server-15.1-1PGDG.rhel7.x86_64.rpm</span><br><span class=\"line\">rpm -ivh postgresql15-contrib-15.1-1PGDG.rhel7.x86_64.rpm</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"初始化数据库\"><a href=\"#初始化数据库\" class=\"headerlink\" title=\"初始化数据库\"></a>初始化数据库</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/usr/pgsql-15/bin/postgresql-15-setup initdb</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"设置自动启动\"><a href=\"#设置自动启动\" class=\"headerlink\" title=\"设置自动启动\"></a>设置自动启动</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl enable postgresql-15</span><br><span class=\"line\">systemctl start postgresql-15</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"创建用户和数据库\"><a href=\"#创建用户和数据库\" class=\"headerlink\" title=\"创建用户和数据库\"></a>创建用户和数据库</h3><p>1、切换postgres用户登录</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">su postgres</span><br></pre></td></tr></table></figure>\n\n<p>2、登录数据库</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">psql</span><br></pre></td></tr></table></figure>\n\n<p>3、创建用户和数据库并授权</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">create user test_user with password &#x27;123456&#x27;;            // 创建用户</span><br><span class=\"line\">create database test_db owner test_user;                 // 创建数据库</span><br><span class=\"line\">grant all privileges on database test_db to test_user;   // 授权</span><br></pre></td></tr></table></figure>\n\n<p>如果不创建用户可以使用数据库默认的用户postgres，可以登录数据库后修改用户密码，然后创建数据库并授权；</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">alter role postgres with password &#x27;your_pwd&#x27;;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"设置远程连接数据库\"><a href=\"#设置远程连接数据库\" class=\"headerlink\" title=\"设置远程连接数据库\"></a>设置远程连接数据库</h3><p>1、编辑文件postgresql.conf</p>\n<p>文件路径为&#x2F;var&#x2F;lib&#x2F;pgsql&#x2F;15&#x2F;data&#x2F;postgresql.conf，取消 listen_addresses的注释并将值改为“*”，取消port的注释；</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">listen_addresses = &#x27;*&#x27;</span><br><span class=\"line\">port = 5432</span><br></pre></td></tr></table></figure>\n\n<p>2、编辑文件pg_hba.conf</p>\n<p>文件路径为&#x2F;var&#x2F;lib&#x2F;pgsql&#x2F;12&#x2F;data&#x2F;pg_hba.conf，在最后添加</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">host    all    all    0.0.0.0/0    md5</span><br></pre></td></tr></table></figure>\n\n<p>3、重启数据库</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart postgresql-15</span><br></pre></td></tr></table></figure>\n\n<p>4、关闭防火墙</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl status firewalld.service  查看状态</span><br><span class=\"line\">systemctl stop firewalld.service  停止</span><br><span class=\"line\">systemctl start firewalld.service  启动</span><br><span class=\"line\">systemctl disable firewalld.service  禁止开机自启</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"连接数据库\"><a href=\"#连接数据库\" class=\"headerlink\" title=\"连接数据库\"></a>连接数据库</h3><p>Dbeaver</p>\n<hr>\n<h2 id=\"欢迎关注公众号收藏小程序\"><a href=\"#欢迎关注公众号收藏小程序\" class=\"headerlink\" title=\"欢迎关注公众号收藏小程序\"></a><center>欢迎关注公众号收藏小程序</center></h2><p><img src=\"https://s2.loli.net/2022/06/23/bYdtKDC2U5J7iWr.jpg\" alt=\"河洛先生\"><img src=\"https://s2.loli.net/2022/06/23/PlUgz5KSHm7OBke.jpg\" alt=\"河洛先生\"></p>\n","more":"<p>Linux服务器安装PostgreSQL数据库</p>\n<img src=\"https://weaoe.com/hexo/img/2022102900.png\" alt=\"PostgreSQL\" style=\"zoom: 80%;\" />\n\n<h2 id=\"下载\"><a href=\"#下载\" class=\"headerlink\" title=\"下载\"></a>下载</h2><ul>\n<li>首先访问<a href=\"https://www.postgresql.org/download/\">https://www.postgresql.org/download/</a></li>\n<li>选择操作系统，下载自己需要的安装包版本</li>\n<li>如果是在线安装，可以直接选在版本、操作系统、架构，然后复制安装命令</li>\n<li>如果是离线安装，直接点击页面最下方的“direc download”进入新页面，选择版本、操作系统、架构后，直接点击Available Groups下的链接，下载安装包。以centos7为例，一般需要下载四个安装包。</li>\n<li>本文使用的最新版本15.0</li>\n</ul>\n<h2 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h2><h3 id=\"上传文件\"><a href=\"#上传文件\" class=\"headerlink\" title=\"上传文件\"></a>上传文件</h3><p>将下载的文件上传到服务器</p>\n<ul>\n<li><p>postgresql15-15.1-1PGDG.rhel7.x86_64.rpm</p>\n</li>\n<li><p>postgresql15-contrib-15.1-1PGDG.rhel7.x86_64.rpm</p>\n</li>\n<li><p>postgresql15-libs-15.1-1PGDG.rhel7.x86_64.rpm</p>\n</li>\n<li><p>postgresql15-server-15.1-1PGDG.rhel7.x86_64.rpm</p>\n</li>\n</ul>\n<h3 id=\"安装顺序\"><a href=\"#安装顺序\" class=\"headerlink\" title=\"安装顺序\"></a>安装顺序</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rpm -ivh postgresql15-libs-15.1-1PGDG.rhel7.x86_64.rpm</span><br><span class=\"line\">rpm -ivh postgresql15-15.1-1PGDG.rhel7.x86_64.rpm</span><br><span class=\"line\">rpm -ivh postgresql15-server-15.1-1PGDG.rhel7.x86_64.rpm</span><br><span class=\"line\">rpm -ivh postgresql15-contrib-15.1-1PGDG.rhel7.x86_64.rpm</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"初始化数据库\"><a href=\"#初始化数据库\" class=\"headerlink\" title=\"初始化数据库\"></a>初始化数据库</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/usr/pgsql-15/bin/postgresql-15-setup initdb</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"设置自动启动\"><a href=\"#设置自动启动\" class=\"headerlink\" title=\"设置自动启动\"></a>设置自动启动</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl enable postgresql-15</span><br><span class=\"line\">systemctl start postgresql-15</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"创建用户和数据库\"><a href=\"#创建用户和数据库\" class=\"headerlink\" title=\"创建用户和数据库\"></a>创建用户和数据库</h3><p>1、切换postgres用户登录</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">su postgres</span><br></pre></td></tr></table></figure>\n\n<p>2、登录数据库</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">psql</span><br></pre></td></tr></table></figure>\n\n<p>3、创建用户和数据库并授权</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">create user test_user with password &#x27;123456&#x27;;            // 创建用户</span><br><span class=\"line\">create database test_db owner test_user;                 // 创建数据库</span><br><span class=\"line\">grant all privileges on database test_db to test_user;   // 授权</span><br></pre></td></tr></table></figure>\n\n<p>如果不创建用户可以使用数据库默认的用户postgres，可以登录数据库后修改用户密码，然后创建数据库并授权；</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">alter role postgres with password &#x27;your_pwd&#x27;;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"设置远程连接数据库\"><a href=\"#设置远程连接数据库\" class=\"headerlink\" title=\"设置远程连接数据库\"></a>设置远程连接数据库</h3><p>1、编辑文件postgresql.conf</p>\n<p>文件路径为&#x2F;var&#x2F;lib&#x2F;pgsql&#x2F;15&#x2F;data&#x2F;postgresql.conf，取消 listen_addresses的注释并将值改为“*”，取消port的注释；</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">listen_addresses = &#x27;*&#x27;</span><br><span class=\"line\">port = 5432</span><br></pre></td></tr></table></figure>\n\n<p>2、编辑文件pg_hba.conf</p>\n<p>文件路径为&#x2F;var&#x2F;lib&#x2F;pgsql&#x2F;12&#x2F;data&#x2F;pg_hba.conf，在最后添加</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">host    all    all    0.0.0.0/0    md5</span><br></pre></td></tr></table></figure>\n\n<p>3、重启数据库</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart postgresql-15</span><br></pre></td></tr></table></figure>\n\n<p>4、关闭防火墙</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl status firewalld.service  查看状态</span><br><span class=\"line\">systemctl stop firewalld.service  停止</span><br><span class=\"line\">systemctl start firewalld.service  启动</span><br><span class=\"line\">systemctl disable firewalld.service  禁止开机自启</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"连接数据库\"><a href=\"#连接数据库\" class=\"headerlink\" title=\"连接数据库\"></a>连接数据库</h3><p>Dbeaver</p>\n<hr>\n<h2 id=\"欢迎关注公众号收藏小程序\"><a href=\"#欢迎关注公众号收藏小程序\" class=\"headerlink\" title=\"欢迎关注公众号收藏小程序\"></a><center>欢迎关注公众号收藏小程序</center></h2><p><img src=\"https://s2.loli.net/2022/06/23/bYdtKDC2U5J7iWr.jpg\" alt=\"河洛先生\"><img src=\"https://s2.loli.net/2022/06/23/PlUgz5KSHm7OBke.jpg\" alt=\"河洛先生\"></p>\n","categories":[{"name":"Linux","path":"api/categories/Linux.json"}],"tags":[{"name":"PostgreSQL","path":"api/tags/PostgreSQL.json"}]}